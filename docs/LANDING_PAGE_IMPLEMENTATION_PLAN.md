# Configurable Pages & Assessment Implementation Plan

**Version:** 1.0  
**Status:** Design & Architecture  
**Date:** October 23, 2025  
**Target:** Multi-tenant Configurable Pages with Lead Qualification Surveys

---

## Executive Summary

This document outlines the complete architecture for a **multi-tenant configurable page system** with an **integrated 15-question qualification survey** that captures leads and routes them based on dynamic scoring. The system is **product-agnostic** and can be used for any type of assessment, lead qualification, customer feedback, or survey needs.

### Key Objectives
1. Create configurable pages (multiple per tenant/company)
2. Implement 15-question configurable survey with 3 mandatory steps
3. Dynamic lead qualification scoring (Cold/Warm/Hot)
4. Lead capture integration (backend via LeadServices, not frontend dependency)
5. Configurable results mapping and next-step routing
6. Admin interface for page and survey management
7. Product-agnostic design (works for any use case)

---

## Part 1: Architecture Overview

### 1.1 System Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GrowERP Multi-Tenant                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend Packages:                                           â”‚
â”‚  â”œâ”€ growerp_core (Shared UI/Auth/State)                     â”‚
â”‚  â”œâ”€ growerp_assessment (NEW: Assessment Building Block)    â”‚
â”‚  â”œâ”€ landing_page (NEW: Public Landing Page App)            â”‚
â”‚  â””â”€ admin (Page & Survey Administration)                    â”‚
â”‚                                                              â”‚
â”‚  Backend (Moqui):                                            â”‚
â”‚  â”œâ”€ growerp/AssessmentServices                              â”‚
â”‚  â”œâ”€ growerp/LandingPageServices                             â”‚
â”‚  â”œâ”€ growerp/LeadServices                                    â”‚
â”‚  â”œâ”€ mantle-udm/OpportunityEntities                          â”‚
â”‚  â””â”€ PopRestStore (Reference Implementation)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Data Flow

```
Configurable Page (Public/Private)
    â†“
User Completes Survey (15 customizable questions)
    â†“
Qualification Scoring Engine
    â†“
Lead Status: Cold/Warm/Hot
    â†“
Results Page (Dynamic CTA based on Score)
    â†“
Lead Captured â†’ Backend creates Opportunity/Lead record
```

### 1.3 ID Strategy (Dual-ID System)

Every backend entity uses two IDs:

| ID Type | Example | Scope | User-Facing? | Backend Use |
|---------|---------|-------|--------------|-------------|
| **Entity ID** | `pageId`, `surveyId`, `leadId` | System-wide unique | âŒ Internal only | Primary key, relationships |
| **Pseudo ID** | `p_abc123xyz`, `s_def456uvw` | Tenant-unique | âœ… Always shown | Queries, API, admin UI |

**Backend Entity Naming Convention:**
- Primary Key: `{entityName}Id` (lowercase first letter, camelCase)
  - Examples: `pageId`, `surveyId`, `surveyQuestionId`, `qualificationResultId`, `leadId`
  - System-wide unique across all tenants
  - Generated by backend (auto-increment or UUID)

- Unique Pseudo ID: `pseudoId` 
  - Tenant-scoped unique identifier
  - Manually assigned, human-readable format (optional)
  - Always shown to users, used in URLs and admin UI
  - Can be queried/selected via API alongside `entityId`

**Backend Selection Strategy:**
- Both `{entityId}` and `pseudoId` can be used for backend queries
- API endpoints support both: `/api/v1/pages/{pageId}` OR `/api/v1/pages/{pseudoId}`
- Services prioritize by specificity: exact match wins
- Moqui services handle both lookup methods transparently

---

## Part 2: Frontend Package Architecture (Flutter)

### 2.1 New Package: `growerp_assessment` (Building Block)

**Location:** `flutter/packages/growerp_assessment/`

**Purpose:** Reusable assessment/survey configuration package (follows growerp_* pattern)

**Dependency:** Depends on `growerp_core` and `growerp_models`

**Structure:**
```
growerp_assessment/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_model.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_question_model.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_result_model.dart
â”‚   â”‚   â”‚   â””â”€â”€ scoring_rule_model.dart
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_service.dart
â”‚   â”‚   â”‚   â””â”€â”€ assessment_scoring_service.dart
â”‚   â”‚   â”œâ”€â”€ bloc/
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_bloc.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_event.dart
â”‚   â”‚   â”‚   â””â”€â”€ assessment_state.dart
â”‚   â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_screen.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ step1_info_screen.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ step2_questions_screen.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ step3_qualification_screen.dart
â”‚   â”‚   â”‚   â””â”€â”€ result_screen.dart
â”‚   â”‚   â”œâ”€â”€ widgets/
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_question_widget.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ progress_indicator.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ score_gauge_widget.dart
â”‚   â”‚   â”‚   â””â”€â”€ result_summary_widget.dart
â”‚   â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â”‚   â””â”€â”€ assessment_constants.dart
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ assessment_calculator.dart
â”‚   â”œâ”€â”€ growerp_assessment.dart (main export)
â”‚   â””â”€â”€ get_assessment_bloc_providers.dart
â”œâ”€â”€ example/
â”‚   â”œâ”€â”€ integration_test/
â”‚   â”‚   â””â”€â”€ assessment_test.dart
â”‚   â””â”€â”€ lib/main.dart
â”œâ”€â”€ pubspec.yaml
â”œâ”€â”€ README.md
â””â”€â”€ CHANGELOG.md
```

### 2.2 New App: `landing_page` (Public-Facing Application)

**Location:** `flutter/packages/landing_page/`

**Purpose:** Public landing page application combining growerp_assessment with configurable page content

**Dependencies:** 
- `growerp_core` (foundation)
- `growerp_models` (data models)
- `growerp_assessment` (reusable assessment building block)

**Note:** Lead integration with marketing/CRM is handled entirely in the backend via LeadServices; no frontend dependency on growerp_marketing.

**Structure:**
```
landing_page/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ landing_page_model.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ page_section_model.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ credibility_model.dart
â”‚   â”‚   â”‚   â””â”€â”€ cta_model.dart
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ landing_page_service.dart
â”‚   â”‚   â”‚   â””â”€â”€ lead_capture_service.dart
â”‚   â”‚   â”œâ”€â”€ bloc/
â”‚   â”‚   â”‚   â”œâ”€â”€ landing_page_bloc.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ landing_page_event.dart
â”‚   â”‚   â”‚   â””â”€â”€ landing_page_state.dart
â”‚   â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”‚   â”œâ”€â”€ landing_page_screen.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ assessment_flow_screen.dart
â”‚   â”‚   â”‚   â””â”€â”€ results_screens/
â”‚   â”‚   â”‚       â”œâ”€â”€ score_reveal_screen.dart
â”‚   â”‚   â”‚       â”œâ”€â”€ insights_screen.dart
â”‚   â”‚   â”‚       â”œâ”€â”€ summary_screen.dart
â”‚   â”‚   â”‚       â””â”€â”€ thank_you_screen.dart
â”‚   â”‚   â”œâ”€â”€ widgets/
â”‚   â”‚   â”‚   â”œâ”€â”€ page_hero.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ section_widget.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ credibility_section.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ cta_button.dart
â”‚   â”‚   â”‚   â””â”€â”€ privacy_policy_link.dart
â”‚   â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â”‚   â””â”€â”€ landing_page_constants.dart
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ page_validators.dart
â”‚   â”œâ”€â”€ landing_page.dart (main export)
â”‚   â””â”€â”€ get_landing_page_bloc_providers.dart
â”œâ”€â”€ pubspec.yaml
â”œâ”€â”€ README.md
â””â”€â”€ CHANGELOG.md
```

### 2.3 Admin Integration

**Location:** `flutter/packages/admin/lib/src/landing_page/`

**Purpose:** Admin screens for managing landing pages and assessments using menu structure

**Dependencies:** landing_page + growerp_assessment packages

**Structure:**
```
admin/lib/src/landing_page/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ landing_page_list_page.dart
â”‚   â”œâ”€â”€ landing_page_detail_page.dart
â”‚   â””â”€â”€ assessment_config_page.dart
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ page_editor_view.dart
â”‚   â”œâ”€â”€ assessment_builder_view.dart
â”‚   â”œâ”€â”€ scoring_config_view.dart
â”‚   â”œâ”€â”€ insights_mapper_view.dart
â”‚   â””â”€â”€ results_dashboard_view.dart
â”œâ”€â”€ widgets/
â”‚   â”œâ”€â”€ page_section_builder.dart
â”‚   â”œâ”€â”€ question_builder_widget.dart
â”‚   â””â”€â”€ cta_mapper_widget.dart
â””â”€â”€ bloc/
    â”œâ”€â”€ admin_landing_page_bloc.dart
    â””â”€â”€ admin_assessment_bloc.dart
```

### 2.4 Data Models in growerp_assessment Package

#### AssessmentModel (Dual-ID Strategy)
```dart
class Assessment {
  // ===== ID FIELDS (Dual-ID System) =====
  final String assessmentId;       // System-wide unique (internal, backend use)
  final String pseudoId;           // Tenant-unique, user-facing
  
  // ===== Core Fields =====
  final String ownerPartyId;       // Tenant reference
  final String pageId;             // Reference to landing page
  final int maxScore;              // Usually 100
  
  // Step 1: Lead Capture Questions
  final List<AssessmentQuestion> infoQuestions;
  
  // Step 2: Survey Questions (configurable, usually 10)
  final List<AssessmentQuestion> surveyQuestions;
  
  // Step 3: Qualification Questions (configurable, usually 5)
  final List<AssessmentQuestion> qualificationQuestions;
  
  // Scoring configuration
  final ScoringRuleEngine scoringRules;
  
  final DateTime createdAt;
  final DateTime updatedAt;
}

class AssessmentQuestion {
  final String questionId;
  final String pseudoId;
  final int questionType;          // 1=info, 2=survey, 3=qualification
  final String question;
  final String fieldType;          // 'text', 'email', 'phone', 'yes_no', 'choice', 'rating'
  final Map<String, double>? answerWeights; // Weight for scoring (survey questions)
  final bool isMandatory;
  final int sequenceNum;
}

class AssessmentResult {
  // ===== ID FIELDS (Dual-ID System) =====
  final String resultId;           // System-wide unique
  final String pseudoId;           // Tenant-unique, user-facing
  
  // ===== Core Fields =====
  final String assessmentId;
  final String pageId;
  final String ownerPartyId;
  
  // Contact info captured
  final String name;
  final String email;
  final String? phone;
  final String? company;
  
  // Scoring results
  final int score;                 // 0-100
  final String status;             // 'Cold', 'Warm', 'Hot', or custom
  
  // Answers
  final Map<String, String> assessmentAnswers;
  final Map<String, String> qualificationAnswers;
  
  // Generated insights
  final List<String> insights;     // 3+ insights
  final String nextStepCTA;        // Dynamic CTA
  final String nextStepType;       // 'consultation', 'presentation', 'resource'
  final DateTime submittedAt;
}

class ScoringRuleEngine {
  final int maxScore;              // Usually 100
  final List<ScoreThreshold> thresholds;
}

class ScoreThreshold {
  final String thresholdId;
  final String pseudoId;
  final String status;             // 'Cold', 'Warm', 'Hot', etc.
  final int minScore;
  final int maxScore;
  final String insightTemplate;    // Template for insights
}
```

### 2.5 Data Models in landing_page App

#### LandingPageModel (Dual-ID Strategy)
```dart
class LandingPage {
  // ===== ID FIELDS (Dual-ID System) =====
  final String pageId;             // System-wide unique
  final String pseudoId;           // Tenant-unique, user-facing (URLs, admin UI)
  
  // ===== Core Fields =====
  final String ownerPartyId;       // Tenant reference
  final String title;              // Page title
  final String hookType;           // 'frustration' | 'results' | 'custom'
  final String headline;           // Main headline
  final String? subheading;        // Optional subtitle
  final List<PageSection> sections;    // Customizable sections
  final CredibilityInfo? credibility;  // Optional bio, background, data
  final PrimaryCTA primaryCTA;     // Button config
  final String? privacyPolicyUrl;  // Compliance link
  
  // Reference to assessment configuration
  final String assessmentId;       // From growerp_assessment package
  final String assessmentPseudoId; // User-facing reference
  
  final DateTime createdAt;
  final DateTime updatedAt;
}

class PageSection {
  final String sectionId;          // Unique per page
  final String pseudoId;           // Unique per page per tenant
  final String title;
  final String description;
  final String? imageUrl;
  final int sequenceNum;
}

class CredibilityInfo {
  final String credibilityId;
  final String pseudoId;
  final String creatorBio;
  final String backgroundText;
  final List<String> supportingStatistics;
  final String? creatorImageUrl;
}

class PrimaryCTA {
  final String buttonText;         // "Start the assessment"
  final String estimatedTime;      // "3 minutes"
  final String cost;               // "Free"
  final String valuePromise;       // "Get immediate recommendations"
}

class LeadFromAssessment {
  // ===== ID FIELDS (Dual-ID System) =====
  final String leadId;             // System-wide unique
  final String pseudoId;           // Tenant-unique, user-facing
  
  // ===== Core Fields =====
  final String ownerPartyId;
  final String resultId;           // Reference to AssessmentResult from growerp_assessment
  final String pageId;             // Source landing page
  
  // Contact Information
  final String firstName;
  final String lastName;
  final String email;
  final String? phone;
  final String? company;
  
  // Qualification metadata
  final int qualificationScore;
  final String qualificationStatus;
  final List<String> qualificationInsights;
  
  // Lead status in marketing
  final String leadStatus;         // 'new', 'contacted', 'qualified', 'converted'
  final DateTime createdAt;
}
```

### 2.6 BLoC Architecture

#### In growerp_assessment Package

**AssessmentBloc**
```dart
// Events
abstract class AssessmentEvent extends Equatable {}
class StartAssessmentEvent extends AssessmentEvent {
  final String assessmentId; // or pseudoId
  final String pageId;
}
class SubmitInfoEvent extends AssessmentEvent {
  final Map<String, String> contactData;
}
class SubmitSurveyEvent extends AssessmentEvent {
  final Map<String, String> answers;
}
class SubmitQualificationEvent extends AssessmentEvent {
  final Map<String, String> answers;
}
class CalculateScoreEvent extends AssessmentEvent {
  final AssessmentResult result;
}

// States
abstract class AssessmentState extends Equatable {}
class AssessmentInitial extends AssessmentState {}
class InfoFormScreen extends AssessmentState {}
class SurveyFormScreen extends AssessmentState {}
class QualificationFormScreen extends AssessmentState {}
class CalculatingScore extends AssessmentState {}
class AssessmentComplete extends AssessmentState {
  final AssessmentResult result;
}
class AssessmentError extends AssessmentState {
  final String message;
}
```

#### In landing_page App

**LandingPageBloc**
```dart
// Events
abstract class LandingPageEvent extends Equatable {}
class LoadLandingPageEvent extends LandingPageEvent {
  final String pageIdOrPseudoId;
}
class CreateLandingPageEvent extends LandingPageEvent {
  final LandingPage page;
}
class UpdateLandingPageEvent extends LandingPageEvent {
  final LandingPage page;
}

// States
abstract class LandingPageState extends Equatable {}
class LandingPageLoading extends LandingPageState {}
class LandingPageSuccess extends LandingPageState {
  final LandingPage page;
  final Assessment assessment; // From growerp_assessment
}
class LandingPageError extends LandingPageState {
  final String message;
}
```

**LeadCaptureBloc**
```dart
// Events
abstract class LeadCaptureEvent extends Equatable {}
class CaptureLeadEvent extends LeadCaptureEvent {
  final AssessmentResult result;
}
class SendLeadNotificationEvent extends LeadCaptureEvent {
  final LeadFromAssessment lead;
}

// States
abstract class LeadCaptureState extends Equatable {}
class LeadCapturing extends LeadCaptureState {}
class LeadCaptureSuccess extends LeadCaptureState {
  final LeadFromAssessment lead;
}
class LeadCaptureError extends LeadCaptureState {
  final String message;
}
```

#### LandingPageScreen (Public-Facing)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Hook/Headline        â”‚  â† Configurable (Frustration/Results)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Subheading           â”‚  â† "Answer 15 questions to find out..."
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Value Proposition       â”‚  â† 3 key areas with icons/images
â”‚  - Area 1                â”‚
â”‚  - Area 2                â”‚
â”‚  - Area 3                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Credibility Section    â”‚  â† Bio, background, statistics
â”‚   [Creator Image]        â”‚
â”‚   [Bio Text]             â”‚
â”‚   [Supporting Data]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Start the quiz     â”‚  â”‚  â† Primary CTA
â”‚  â”‚ 3 minutes, Free    â”‚  â”‚
â”‚  â”‚ Get immediate      â”‚  â”‚
â”‚  â”‚ recommendations    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Privacy Policy Link]   â”‚  â† Friction minimizer
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Implementation Notes:**
- Fully responsive (mobile-first design)
- Static content with dynamic configuration
- Image hosting via REST API (URLs stored in database)
- Privacy policy lightbox overlay

#### Assessment Screens (3-Step Flow)

**Step 1: Contact Info Screen**
```
Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 33%
Question 1/3

What is your full name?
[Text Input: placeholder="John Doe"]

What is your email address? â˜…
[Email Input: placeholder="john@example.com"]

What is your phone number?
[Phone Input: placeholder="+1 (555) 000-0000"]

[â† Back] [Next â†’]
```

**Step 2: Best Practices Screen (10 Questions)**
```
Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 66%
Question 1-10 of 10

[Question with Radio Buttons]
â—‹ Yes - We have workflow automation
â—‹ No - Manual data entry

[Scrollable list of 10 questions]

[â† Back] [Next â†’]
```

**Step 3: Qualification Screen (5 Big Five)**
```
Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%
Question 1-5 of 5

[Question with Dropdown/Radio]
â—‹ Option 1
â—‹ Option 2
â—‹ Option 3

[Open-ended text area for final question]

[â† Back] [Submit] [Start Over]
```

#### Results Screens (Multi-Page Flow)

**Screen 1: Score Reveal**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Results       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      â”‚
â”‚    â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®   â”‚
â”‚    â”‚             â”‚   â”‚
â”‚    â”‚  75% READY  â”‚   â”‚  â† Thermometer/Gauge
â”‚    â”‚   STRONG    â”‚   â”‚     Visualization
â”‚    â”‚ FOUNDATIONS â”‚   â”‚
â”‚    â”‚             â”‚   â”‚
â”‚    â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯   â”‚
â”‚                      â”‚
â”‚  You're in great     â”‚
â”‚  shape to optimize   â”‚
â”‚  your operations!    â”‚
â”‚                      â”‚
â”‚  [Next Insight â†’]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Screen 2: Three Insights**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Insights      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¡ Insight 1        â”‚
â”‚  "Focus on customer  â”‚
â”‚   data centralizationâ”‚"
â”‚                      â”‚
â”‚  ğŸ’¡ Insight 2        â”‚
â”‚  "Real-time         â”‚
â”‚   reporting will     â”‚
â”‚   transform your     â”‚
â”‚   decision-making"   â”‚
â”‚                      â”‚
â”‚  ğŸ’¡ Insight 3        â”‚
â”‚  "Mobile access is   â”‚
â”‚   critical for your  â”‚
â”‚   team efficiency"   â”‚
â”‚                      â”‚
â”‚  [Next Summary â†’]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Screen 3: Qualification Summary**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Situation     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Growth Stage:        â”‚
â”‚ Mid-market firm      â”‚
â”‚                      â”‚
â”‚ Key Objective:       â”‚
â”‚ Reduce costs 15%+    â”‚
â”‚                      â”‚
â”‚ Primary Obstacle:    â”‚
â”‚ Internal resistance  â”‚
â”‚                      â”‚
â”‚ Solution Preference: â”‚
â”‚ Modular SaaS         â”‚
â”‚                      â”‚
â”‚  [Next Action â†’]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Screen 4: Thank You & CTA**

*Scenario A: Hot Lead (High Score + High Budget)*
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Next Step     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜… Congratulations!   â”‚
â”‚   You're ready for   â”‚
â”‚   a 1:1 Consultationâ”‚
â”‚                      â”‚
â”‚ Our ERP specialist   â”‚
â”‚ will discuss:        â”‚
â”‚ - Your specific needsâ”‚
â”‚ - Implementation     â”‚
â”‚   roadmap            â”‚
â”‚ - Timeline & costs   â”‚
â”‚                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Schedule Call  â”‚   â”‚ â† CTA changes based on status
â”‚ â”‚ (Calendly Link)â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                      â”‚
â”‚ [Download E-book]    â”‚
â”‚ [Follow Us]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Scenario B: Warm Lead (Mid Score + Medium Budget)*
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Next Step     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Join our Group       â”‚
â”‚ Presentation this    â”‚
â”‚ Thursday at 2 PM     â”‚
â”‚                      â”‚
â”‚ Learn how modular    â”‚
â”‚ SaaS scales with     â”‚
â”‚ your business        â”‚
â”‚                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Register Now   â”‚   â”‚
â”‚ â”‚ (Event Link)   â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                      â”‚
â”‚ â†“ PLUS â†“             â”‚
â”‚                      â”‚
â”‚ Free E-Book:         â”‚
â”‚ "Getting Started"    â”‚
â”‚ [Download PDF]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Scenario C: Cold Lead (Low Score + Low Budget)*
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Your Next Step     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Start with:          â”‚
â”‚ "ERP Fundamentals"   â”‚
â”‚ Video Series         â”‚
â”‚                      â”‚
â”‚ Perfect for teams    â”‚
â”‚ exploring ERP basics â”‚
â”‚                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Watch Free     â”‚   â”‚
â”‚ â”‚ (YouTube Link) â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                      â”‚
â”‚ Also recommended:    â”‚
â”‚ - Blog: Getting      â”‚
â”‚   Started with ERP   â”‚
â”‚ - Podcast: ERP for   â”‚
â”‚   Growing Businesses â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.7 Service Layer

#### In growerp_assessment Package

**AssessmentService**
```dart
class AssessmentService {
  // Fetch assessment by ID (can use either assessmentId or pseudoId)
  Future<Assessment> getAssessment(String assessmentIdOrPseudoId);
  
  // List all assessments for company (admin)
  Future<List<Assessment>> listAssessments(String ownerPartyId);
  
  // Create new assessment
  Future<Assessment> createAssessment(Assessment assessment);
  
  // Update assessment
  Future<Assessment> updateAssessment(Assessment assessment);
  
  // Delete assessment
  Future<void> deleteAssessment(String assessmentIdOrPseudoId);
}
```

**AssessmentScoringService**
```dart
class AssessmentScoringService {
  // Calculate score from assessment answers
  int calculateScore(
    Map<String, String> surveyAnswers,
    ScoringRuleEngine rules,
  );
  
  // Determine status based on score thresholds
  String determineStatus(int score, ScoringRuleEngine rules);
  
  // Generate insights from answered questions
  List<String> generateInsights(
    AssessmentResult result,
    List<ScoreThreshold> thresholds,
  );
  
  // Determine next step based on score
  NextStep determineNextStep(int score, List<ScoreThreshold> thresholds);
}

class NextStep {
  final String type;               // 'consultation', 'presentation', 'resource', etc.
  final String cta;                // Button text
  final String? link;              // URL to calendar, event, resource, etc.
  final String description;
}
```

#### In landing_page App

**LandingPageService**
```dart
class LandingPageService {
  // Fetch landing page by ID (can use either pageId or pseudoId)
  Future<LandingPage> getLandingPage(String pageIdOrPseudoId);
  
  // List all landing pages for company (admin)
  Future<List<LandingPage>> listLandingPages(String ownerPartyId);
  
  // Create new landing page
  Future<LandingPage> createLandingPage(LandingPage page);
  
  // Update landing page
  Future<LandingPage> updateLandingPage(LandingPage page);
  
  // Delete landing page
  Future<void> deleteLandingPage(String pageIdOrPseudoId);
  
  // Get associated assessment from growerp_assessment
  Future<Assessment> getAssessmentForPage(String pageIdOrPseudoId);
}
```

**LeadCaptureService**
```dart
class LeadCaptureService {
  // Convert assessment result to lead
  Future<LeadFromAssessment> convertResultToLead(
    AssessmentResult result,
    String pageId,
  );
  
  // Create lead via backend (backend creates Opportunity/Lead record)
  Future<void> createLeadInBackend(LeadFromAssessment lead);
  
  // Update lead status
  Future<void> updateLeadStatus(String leadIdOrPseudoId, String status);
  
  // Notify relevant team members
  Future<void> notifyTeam(LeadFromAssessment lead);
}
```

---

---

## Part 3: Backend Architecture (Moqui)

### 3.1 Backend Services for growerp_assessment Package

**Location:** `moqui/runtime/component/growerp/service/`

#### AssessmentServices.xml
```xml
<!-- Get Assessment by ID (supports both assessmentId and pseudoId) -->
<service verb="get" noun="Assessment">
  <description>Fetch an assessment by assessmentId or pseudoId</description>
  <in-parameters>
    <parameter name="assessmentId" type="String"/>
    <parameter name="pseudoId" type="String"/>
  </in-parameters>
  <out-parameters>
    <parameter name="assessment" type="Map"/>
  </out-parameters>
</service>

<!-- List Assessments for company -->
<service verb="list" noun="Assessments">
  <description>List all assessments for a company, multi-tenant filtered</description>
  <in-parameters>
    <parameter name="ownerPartyId" type="String" required="true"/>
    <parameter name="pageIndex" type="int" default="0"/>
    <parameter name="pageSize" type="int" default="20"/>
  </in-parameters>
  <out-parameters>
    <parameter name="assessments" type="List"/>
    <parameter name="count" type="int"/>
  </out-parameters>
</service>

<!-- Create Assessment -->
<service verb="create" noun="Assessment">
  <description>Create a new assessment with automatic ID generation</description>
  <in-parameters>
    <parameter name="ownerPartyId" type="String" required="true"/>
    <parameter name="pseudoId" type="String"/> <!-- Optional, auto-generate if not provided -->
    <parameter name="pageId" type="String" required="true"/>
    <parameter name="maxScore" type="int" default="100"/>
    <!-- ... other fields ... -->
  </in-parameters>
  <out-parameters>
    <parameter name="assessmentId" type="String"/>
    <parameter name="pseudoId" type="String"/>
  </out-parameters>
</service>

<!-- Update Assessment (supports both IDs) -->
<service verb="update" noun="Assessment">
  <in-parameters>
    <parameter name="assessmentId" type="String"/>
    <parameter name="pseudoId" type="String"/>
    <!-- ... other fields to update ... -->
  </in-parameters>
</service>

<!-- Delete Assessment (supports both IDs) -->
<service verb="delete" noun="Assessment">
  <in-parameters>
    <parameter name="assessmentId" type="String"/>
    <parameter name="pseudoId" type="String"/>
  </in-parameters>
</service>

<!-- Submit Assessment Answers -->
<service verb="submit" noun="AssessmentAnswers">
  <description>Process assessment submission and calculate score</description>
  <in-parameters>
    <parameter name="assessmentId" type="String"/>
    <parameter name="pseudoId" type="String"/>
    <parameter name="infoAnswers" type="Map" required="true"/>
    <parameter name="surveyAnswers" type="Map" required="true"/>
    <parameter name="qualificationAnswers" type="Map" required="true"/>
  </in-parameters>
  <out-parameters>
    <parameter name="resultId" type="String"/>
    <parameter name="pseudoId" type="String"/>
    <parameter name="score" type="int"/>
    <parameter name="status" type="String"/>
  </out-parameters>
</service>

<!-- Calculate Assessment Score -->
<service verb="calculate" noun="AssessmentScore">
  <in-parameters>
    <parameter name="assessmentId" type="String"/>
    <parameter name="pseudoId" type="String"/>
    <parameter name="answers" type="Map" required="true"/>
  </in-parameters>
  <out-parameters>
    <parameter name="score" type="int"/>
    <parameter name="status" type="String"/>
    <parameter name="insights" type="List"/>
    <parameter name="nextStepType" type="String"/>
  </out-parameters>
</service>
```

### 3.2 Backend Services for landing_page App

**Location:** `moqui/runtime/component/growerp/service/`

#### LandingPageServices.xml
```xml
<!-- Get Landing Page by ID (supports both pageId and pseudoId) -->
<service verb="get" noun="LandingPage">
  <description>Fetch a landing page by pageId or pseudoId</description>
  <in-parameters>
    <parameter name="pageId" type="String"/>
    <parameter name="pseudoId" type="String"/>
  </in-parameters>
  <out-parameters>
    <parameter name="page" type="Map"/>
  </out-parameters>
</service>

<!-- List Landing Pages for company -->
<service verb="list" noun="LandingPages">
  <description>List all landing pages for a company, multi-tenant filtered</description>
  <in-parameters>
    <parameter name="ownerPartyId" type="String" required="true"/>
    <parameter name="pageIndex" type="int" default="0"/>
    <parameter name="pageSize" type="int" default="20"/>
  </in-parameters>
  <out-parameters>
    <parameter name="pages" type="List"/>
    <parameter name="count" type="int"/>
  </out-parameters>
</service>

<!-- Create Landing Page -->
<service verb="create" noun="LandingPage">
  <description>Create a new landing page with automatic ID generation</description>
  <in-parameters>
    <parameter name="ownerPartyId" type="String" required="true"/>
    <parameter name="pseudoId" type="String"/> <!-- Optional, auto-generate if not provided -->
    <parameter name="title" type="String" required="true"/>
    <parameter name="hookType" type="String" required="true"/>
    <parameter name="headline" type="String" required="true"/>
    <parameter name="assessmentId" type="String"/> <!-- Reference to growerp_assessment -->
    <!-- ... other fields ... -->
  </in-parameters>
  <out-parameters>
    <parameter name="pageId" type="String"/>
    <parameter name="pseudoId" type="String"/>
  </out-parameters>
</service>

<!-- Update Landing Page (supports both IDs) -->
<service verb="update" noun="LandingPage">
  <in-parameters>
    <parameter name="pageId" type="String"/>
    <parameter name="pseudoId" type="String"/>
    <!-- ... other fields to update ... -->
  </in-parameters>
</service>

<!-- Delete Landing Page (supports both IDs) -->
<service verb="delete" noun="LandingPage">
  <in-parameters>
    <parameter name="pageId" type="String"/>
    <parameter name="pseudoId" type="String"/>
  </in-parameters>
</service>
```

#### LeadServices.xml
```xml
<!-- Create Lead from Assessment Result -->
<service verb="create" noun="AssessmentLead">
  <description>Convert assessment result to lead and create Opportunity</description>
  <in-parameters>
    <parameter name="resultId" type="String"/>
    <parameter name="pseudoId" type="String"/>
    <parameter name="pageId" type="String"/>
    <parameter name="ownerPartyId" type="String" required="true"/>
  </in-parameters>
  <out-parameters>
    <parameter name="leadId" type="String"/>
    <parameter name="pseudoId" type="String"/>
    <parameter name="opportunityId" type="String"/>
  </out-parameters>
</service>

<!-- Get Lead by ID (supports both leadId and pseudoId) -->
<service verb="get" noun="AssessmentLead">
  <in-parameters>
    <parameter name="leadId" type="String"/>
    <parameter name="pseudoId" type="String"/>
  </in-parameters>
  <out-parameters>
    <parameter name="lead" type="Map"/>
  </out-parameters>
</service>
```

### 3.3 ID Strategy in Moqui Services

All backend selections support **both** `entityId` and `pseudoId`:

```xml
<!-- Services accept either parameter for flexibility -->
<in-parameter name="assessmentId" type="String"/> <!-- System-wide unique ID -->
<in-parameter name="pseudoId" type="String"/> <!-- Tenant-unique ID -->
<!-- Backend logic: try exact match first, then lookup -->
```

### 3.4 Data Entities for growerp_assessment Package

**Location:** `moqui/runtime/component/growerp/entity/`

#### AssessmentEntities.xml
```xml
<!-- Main Assessment Entity with Dual IDs -->
<entity entity-name="Assessment" package="growerp">
  <field name="assessmentId" type="id" is-pk="true"/>        <!-- System-wide unique -->
  <field name="pseudoId" type="id" is-unique="true"/>        <!-- Tenant-unique, user-facing -->
  <field name="pageId" type="id" is-fk="true"/>              <!-- Reference to landing page -->
  <field name="ownerPartyId" type="id" is-fk="true"/>
  <field name="maxScore" type="number-integer" default="100"/>
  <field name="createdAt" type="date-time"/>
  <field name="updatedAt" type="date-time"/>
  
  <!-- Relationships: One Assessment has many Questions -->
  <relationship type="many" rel-entity-name="AssessmentQuestion">
    <key-map field-name="assessmentId" rel-field-name="assessmentId"/>
  </relationship>
</entity>

<!-- Assessment Questions (Step 1, 2, or 3) -->
<entity entity-name="AssessmentQuestion" package="growerp">
  <field name="questionId" type="id" is-pk="true"/>         <!-- System-wide unique -->
  <field name="pseudoId" type="id" is-unique="true"/>       <!-- Tenant-unique -->
  <field name="assessmentId" type="id" is-fk="true"/>
  <field name="questionType" type="number-integer"/>        <!-- 1=info, 2=survey, 3=qualification -->
  <field name="question" type="text-very-long" is-required="true"/>
  <field name="fieldType" type="text-short"/>               <!-- text, email, phone, yes_no, choice, rating -->
  <field name="isMandatory" type="text-indicator" default="Y"/>
  <field name="sequenceNum" type="number-integer"/>
  
  <!-- Relationships: One Question has many Options -->
  <relationship type="many" rel-entity-name="AssessmentQuestionOption">
    <key-map field-name="questionId" rel-field-name="questionId"/>
  </relationship>
</entity>

<!-- Question Answer Options (Multiple Choice) -->
<entity entity-name="AssessmentQuestionOption" package="growerp">
  <field name="optionId" type="id" is-pk="true"/>
  <field name="pseudoId" type="id" is-unique="true"/>
  <field name="questionId" type="id" is-fk="true"/>
  <field name="optionText" type="text-medium"/>
  <field name="optionWeight" type="number-decimal"/>        <!-- Weight for scoring -->
  <field name="sequenceNum" type="number-integer"/>
</entity>

<!-- Scoring Configuration -->
<entity entity-name="ScoringThreshold" package="growerp">
  <field name="thresholdId" type="id" is-pk="true"/>
  <field name="pseudoId" type="id" is-unique="true"/>
  <field name="assessmentId" type="id" is-fk="true"/>
  <field name="status" type="text-short"/>                  <!-- Cold, Warm, Hot, etc. -->
  <field name="minScore" type="number-integer"/>
  <field name="maxScore" type="number-integer"/>
  <field name="insightTemplate" type="text-very-long"/>    <!-- Template for insights -->
</entity>

<!-- Assessment Result (After Submission) -->
<entity entity-name="AssessmentResult" package="growerp">
  <field name="resultId" type="id" is-pk="true"/>           <!-- System-wide unique -->
  <field name="pseudoId" type="id" is-unique="true"/>       <!-- Tenant-unique, user-facing -->
  <field name="assessmentId" type="id" is-fk="true"/>
  <field name="pageId" type="id" is-fk="true"/>
  <field name="ownerPartyId" type="id" is-fk="true"/>
  
  <!-- Contact Information Captured -->
  <field name="firstName" type="text-medium"/>
  <field name="lastName" type="text-medium"/>
  <field name="email" type="text-medium"/>
  <field name="phone" type="text-short"/>
  <field name="company" type="text-medium"/>
  
  <!-- Scoring Results -->
  <field name="score" type="number-integer"/>
  <field name="status" type="text-short"/>                  <!-- Cold, Warm, Hot -->
  
  <!-- Answers and Insights -->
  <field name="answersJson" type="text-very-long"/>         <!-- JSON of all answers -->
  <field name="insightsJson" type="text-very-long"/>        <!-- Generated insights -->
  <field name="nextStepType" type="text-short"/>            <!-- consultation, presentation, resource -->
  <field name="submittedAt" type="date-time"/>
</entity>
```

### 3.5 Data Entities for landing_page App

**Location:** `moqui/runtime/component/growerp/entity/`

#### LandingPageEntities.xml
```xml
<!-- Main Landing Page Entity with Dual IDs -->
<entity entity-name="LandingPage" package="growerp">
  <field name="pageId" type="id" is-pk="true"/>             <!-- System-wide unique -->
  <field name="pseudoId" type="id" is-unique="true"/>       <!-- Tenant-unique, user-facing -->
  <field name="ownerPartyId" type="id" is-fk="true"/>
  <field name="assessmentId" type="id" is-fk="true"/>       <!-- Reference to Assessment from growerp_assessment -->
  <field name="title" type="text-medium" is-required="true"/>
  <field name="hookType" type="text-short"/>                <!-- frustration | results | custom -->
  <field name="headline" type="text-long" is-required="true"/>
  <field name="subheading" type="text-long"/>
  <field name="privacyPolicyUrl" type="text-long"/>
  <field name="createdAt" type="date-time"/>
  <field name="updatedAt" type="date-time"/>
  
  <!-- Relationships -->
  <relationship type="many" rel-entity-name="PageSection">
    <key-map field-name="pageId" rel-field-name="pageId"/>
  </relationship>
</entity>

<!-- Page Sections (Reusable Content Blocks) -->
<entity entity-name="PageSection" package="growerp">
  <field name="sectionId" type="id" is-pk="true"/>         <!-- System-wide unique -->
  <field name="pseudoId" type="id" is-unique="true"/>      <!-- Tenant-unique -->
  <field name="pageId" type="id" is-fk="true"/>
  <field name="title" type="text-medium"/>
  <field name="description" type="text-long"/>
  <field name="imageUrl" type="text-long"/>
  <field name="sequenceNum" type="number-integer"/>
</entity>

<!-- Credibility Section (Optional) -->
<entity entity-name="CredibilityInfo" package="growerp">
  <field name="credibilityId" type="id" is-pk="true"/>
  <field name="pseudoId" type="id" is-unique="true"/>
  <field name="pageId" type="id" is-fk="true"/>
  <field name="creatorBio" type="text-very-long"/>
  <field name="backgroundText" type="text-very-long"/>
  <field name="creatorImageUrl" type="text-long"/>
</entity>

<!-- Credibility Statistics (Multiple per CredibilityInfo) -->
<entity entity-name="CredibilityStatistic" package="growerp">
  <field name="statisticId" type="id" is-pk="true"/>
  <field name="pseudoId" type="id" is-unique="true"/>
  <field name="credibilityId" type="id" is-fk="true"/>
  <field name="statistic" type="text-long"/>
  <field name="sequenceNum" type="number-integer"/>
</entity>

<!-- Primary CTA Button Configuration -->
<entity entity-name="PrimaryCTA" package="growerp">
  <field name="ctaId" type="id" is-pk="true"/>
  <field name="pseudoId" type="id" is-unique="true"/>
  <field name="pageId" type="id" is-fk="true"/>
  <field name="buttonText" type="text-short"/>
  <field name="estimatedTime" type="text-short"/>
  <field name="cost" type="text-short"/>
  <field name="valuePromise" type="text-long"/>
</entity>

<!-- Lead (From Assessment & Marketing Integration) -->
<entity entity-name="AssessmentLead" package="growerp">
  <field name="leadId" type="id" is-pk="true"/>             <!-- System-wide unique -->
  <field name="pseudoId" type="id" is-unique="true"/>       <!-- Tenant-unique -->
  <field name="ownerPartyId" type="id" is-fk="true"/>
  <field name="resultId" type="id" is-fk="true"/>           <!-- Reference to AssessmentResult -->
  <field name="pageId" type="id" is-fk="true"/>             <!-- Source page -->
  
  <!-- Contact Information -->
  <field name="firstName" type="text-medium"/>
  <field name="lastName" type="text-medium"/>
  <field name="email" type="text-medium"/>
  <field name="phone" type="text-short"/>
  <field name="company" type="text-medium"/>
  
  <!-- Qualification Metadata -->
  <field name="qualificationScore" type="number-integer"/>
  <field name="qualificationStatus" type="text-short"/>    <!-- Cold, Warm, Hot -->
  <field name="qualificationInsights" type="text-very-long"/> <!-- JSON array -->
  
  <!-- Lead Status in Marketing -->
  <field name="leadStatus" type="text-short"/>              <!-- new, contacted, qualified, converted -->
  <field name="assignedToUserId" type="id"/>
  <field name="createdAt" type="date-time"/>
  <field name="updatedAt" type="date-time"/>
</entity>
```

### 3.6 Backend Integration: Lead Record Creation

**Backend Service:** Creates lead records and optionally Opportunity entities when a qualified lead submits the assessment

**Opportunity Entity** (existing in mantle-udm, optionally extended):
```xml
<entity entity-name="Opportunity" package="mantle-udm">
  <!-- Existing fields + optional assessment-related fields -->
  <field name="resultId" type="id"/>                        <!-- Link to AssessmentResult -->
  <field name="resultPseudoId" type="id"/>                 <!-- Tenant-unique reference -->
  <field name="qualificationScore" type="number-integer"/>
  <field name="qualificationStatus" type="text-short"/>    <!-- Cold, Warm, Hot -->
  <field name="recommendedAction" type="text-short"/>      <!-- consultation, presentation, resource -->
  <field name="pageId" type="id"/>                          <!-- Source landing page -->
  <field name="pagePseudoId" type="id"/>                   <!-- Tenant-unique reference -->
</entity>
```

**Note:** landing_page app frontend has NO dependency on growerp_marketing; lead creation is entirely handled by backend LeadServices.

---

## Part 4: Admin Package Integration

### 4.1 Admin Module Structure for Landing Pages (Menu-Based)

**Location:** `flutter/packages/admin/lib/src/landing_page/`

**Integration:** Uses menu structure from growerp_core to access landing page and assessment features

**Menu Items:**
```
â”œâ”€ Landing Pages (Main)
â”‚  â”œâ”€ List Landing Pages
â”‚  â”œâ”€ Create New Landing Page
â”‚  â””â”€ [Edit] [Delete] [Preview] [Copy]
â”‚
â”œâ”€ Assessment Configuration (Submenu)
â”‚  â”œâ”€ List Assessments
â”‚  â”œâ”€ Create New Assessment
â”‚  â”œâ”€ Question Builder
â”‚  â””â”€ Scoring Configuration
â”‚
â””â”€ Results Dashboard
   â”œâ”€ Overview Metrics
   â”œâ”€ Results by Status
   â”œâ”€ Results by Page
   â””â”€ [Export] [Filter] [Search]
```

### 4.2 Admin Workflows (Product-Agnostic)

#### Workflow 1: Create Landing Page with Assessment
```
1. Admin clicks "Create Landing Page"
2. Enters basic info (Title, Hook Type)
3. Configures hero section (Headline, Subheading)
4. Adds/reorders content sections
5. Optional: Adds credibility section
6. Configures primary CTA button
7. Selects or creates Assessment:
   â”œâ”€ If new: Opens Assessment Builder
   â”œâ”€ If existing: Selects from dropdown (pseudoIds shown)
8. Sets privacy policy link
9. Previews page
10. Publishes to unique pseudoId URL
```

#### Workflow 2: Build/Configure Assessment
```
1. Admin clicks "Create Assessment"
2. Builds Step 1: Info Questions
   â”œâ”€ Name, Email, Phone, Company (customizable)
   â””â”€ Make each required/optional
3. Builds Step 2: Survey Questions (10 default, customizable)
   â”œâ”€ Add/edit questions
   â”œâ”€ Set scoring weights per answer
   â””â”€ Reorder questions
4. Builds Step 3: Qualification Questions (5 default, customizable)
   â”œâ”€ Add/edit questions
   â””â”€ Reorder questions
5. Configures Scoring Rules
   â”œâ”€ Sets score ranges (0-100)
   â”œâ”€ Defines thresholds (Cold/Warm/Hot)
   â””â”€ Templates for insights per threshold
6. Maps Insights (conditional logic support)
7. Saves assessment with pseudoId
```

#### Workflow 3: View Assessment Results
```
1. Admin clicks "Results Dashboard"
2. Sees overview metrics
   â”œâ”€ Total responses
   â”œâ”€ This month
   â”œâ”€ Completion rate
   â””â”€ Average score
3. Filters results by:
   â”œâ”€ Landing page (pseudoId dropdown)
   â”œâ”€ Status (Cold/Warm/Hot)
   â”œâ”€ Date range
   â””â”€ Search (email, name)
4. Views result list (showing pseudoIds)
5. Clicks result to see detail:
   â”œâ”€ All contact info
   â”œâ”€ All answers
   â”œâ”€ Score & status
   â”œâ”€ Generated insights
   â””â”€ Next step CTA
6. Exports as CSV or JSON
```

### 4.3 Admin UI Components (Using Menu Structure)

**File Structure:**
```
admin/lib/src/landing_page/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ landing_page_main_page.dart          # Menu entry point
â”‚   â”œâ”€â”€ landing_page_list_page.dart
â”‚   â”œâ”€â”€ landing_page_detail_page.dart
â”‚   â”œâ”€â”€ landing_page_editor_page.dart
â”‚   â”œâ”€â”€ assessment_list_page.dart
â”‚   â”œâ”€â”€ assessment_builder_page.dart
â”‚   â””â”€â”€ results_dashboard_page.dart
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ landing_page_list_view.dart
â”‚   â”œâ”€â”€ landing_page_editor_view.dart
â”‚   â”œâ”€â”€ assessment_builder_view.dart
â”‚   â”œâ”€â”€ scoring_config_view.dart
â”‚   â”œâ”€â”€ insights_mapper_view.dart
â”‚   â””â”€â”€ results_list_view.dart
â”œâ”€â”€ widgets/
â”‚   â”œâ”€â”€ page_preview_widget.dart
â”‚   â”œâ”€â”€ section_editor_widget.dart
â”‚   â”œâ”€â”€ question_builder_widget.dart
â”‚   â”œâ”€â”€ cta_mapper_widget.dart
â”‚   â””â”€â”€ results_filter_widget.dart
â””â”€â”€ bloc/
    â”œâ”€â”€ admin_landing_page_bloc.dart
    â””â”€â”€ admin_assessment_bloc.dart
```

### 4.4 Results Dashboard Metrics

**Displayed Metrics:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Landing Page Results Dashboard          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ Overview Metrics:                       â”‚
â”‚ â”œâ”€ Total Responses: 1,234               â”‚
â”‚ â”œâ”€ This Month: 156                      â”‚
â”‚ â”œâ”€ Completion Rate: 78%                 â”‚
â”‚ â””â”€ Average Score: 62%                   â”‚
â”‚                                         â”‚
â”‚ Status Distribution:                    â”‚
â”‚ â”œâ”€ Cold: 45% (561)                      â”‚
â”‚ â”œâ”€ Warm: 35% (433)                      â”‚
â”‚ â””â”€ Hot: 20% (240)                       â”‚
â”‚                                         â”‚
â”‚ By Landing Page:                        â”‚
â”‚ â”œâ”€ page_product_readiness: 450          â”‚
â”‚ â”œâ”€ page_maturity_assessment: 320        â”‚
â”‚ â””â”€ page_capabilities_check: 464         â”‚
â”‚                                         â”‚
â”‚ Results List (All pseudoIds shown):     â”‚
â”‚ â”œâ”€ [Filter] [Search] [Export CSV]       â”‚
â”‚ â”œâ”€ Name | Email | Score | Status | Date â”‚
â”‚ â”œâ”€ John Doe | john@... | 85 | Hot | 22  â”‚
â”‚ â””â”€ ...more results...                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 5: Implementation Phases (Package-Based)

### Phase 1: Core Foundation & growerp_assessment Package (Weeks 1-2)

**Frontend (growerp_assessment):**
- [ ] Create `growerp_assessment` package structure
- [ ] Implement AssessmentModel, AssessmentQuestion, AssessmentResult with dual-ID strategy
- [ ] Create AssessmentService with dual-ID query support
- [ ] Create AssessmentScoringService
- [ ] Build AssessmentBloc with event/state handlers
- [ ] Implement basic assessment screens (info + skeleton for other steps)
- [ ] Add assessment widgets (progress indicator, etc.)
- [ ] Comprehensive unit tests for models and services

**Backend:**
- [ ] Create AssessmentEntities.xml with dual IDs (assessmentId + pseudoId)
- [ ] Create AssessmentResult, ScoringThreshold entities
- [ ] Implement AssessmentServices.xml (get, list, create, update, delete)
- [ ] Implement assessment submission service
- [ ] Create database seed data for test assessment
- [ ] All services support both assessmentId and pseudoId

**Documentation:**
- [ ] Add growerp_assessment README with API docs
- [ ] Document dual-ID strategy in comments
- [ ] Create assessment configuration guide

**Verification:**
- [ ] Package successfully imports into other projects
- [ ] Dual-ID lookups work (both assessmentId and pseudoId)
- [ ] Unit tests pass

### Phase 2: Landing Page App & Assessment UI (Weeks 3-4)

**Frontend (landing_page App):**
- [ ] Create `landing_page` app package
- [ ] Import and integrate `growerp_assessment` package
- [ ] Implement LandingPageModel, PageSection, CredibilityInfo with dual-IDs
- [ ] Create LandingPageService with dual-ID support
- [ ] Build LandingPageBloc
- [ ] Implement LandingPageScreen (hero section + CTA)
- [ ] Complete assessment flow screens (Step 1, 2, 3)
- [ ] Integrate AssessmentBloc from growerp_assessment
- [ ] Wire up navigation between screens
- [ ] Test with multiple assessment configurations

**Frontend (Admin Package):**
- [ ] Add landing_page module to admin package
- [ ] Implement landing page list view (showing pseudoIds)
- [ ] Implement landing page editor (create/update workflows)
- [ ] Add landing page preview functionality
- [ ] Integrate assessment builder from growerp_assessment for admin
- [ ] All admin displays use pseudoIds

**Backend:**
- [ ] Create LandingPageEntities.xml with dual IDs
- [ ] Implement LandingPageServices.xml (get, list, create, update, delete)
- [ ] Add foreign key to Assessment
- [ ] Create sample landing page + assessment combo
- [ ] All services support both pageId and pseudoId

**Verification:**
- [ ] Public landing page displays correctly
- [ ] Assessment steps navigate properly
- [ ] Admin can create landing pages
- [ ] Admin can configure assessments

### Phase 3: Scoring & Dynamic Results (Weeks 5-6)

**Frontend (growerp_assessment):**
- [ ] Implement score reveal screen with visualization
- [ ] Build insights screen (multi-card display)
- [ ] Implement qualification summary screen
- [ ] Create score gauge widget (circular progress visualization)
- [ ] Add animations for score reveal

**Frontend (landing_page App):**
- [ ] Implement results flow screens (4-page experience)
- [ ] Add dynamic CTA determination logic
- [ ] Implement thank you screen with personalized CTA
- [ ] Wire up results pages to assessment completion
- [ ] Add analytics tracking for results view

**Backend:**
- [ ] Implement dynamic CTA determination service
- [ ] Create insight generation from templates
- [ ] Add result storage with JSON answers/insights
- [ ] Implement filtering by status/page in queries

**Admin:**
- [ ] Build scoring configuration UI
- [ ] Implement insights mapper (conditional template logic)
- [ ] Add CTA customization per threshold
- [ ] Test with various score scenarios

**Verification:**
- [ ] Scoring calculates correctly
- [ ] Results display with proper status
- [ ] Insights generate from templates
- [ ] CTAs route appropriately

### Phase 4: Lead Integration & Results Dashboard (Weeks 7-8)

**Frontend (landing_page App):**
- [ ] Implement LeadCaptureService
- [ ] Add lead capture on survey completion
- [ ] Implement success notifications

**Frontend (Admin Package):**
- [ ] Add results/leads dashboard
- [ ] Implement filtering (by page, status, date)
- [ ] Add search functionality
- [ ] Implement export (CSV/JSON)
- [ ] Add lead detail view
- [ ] Support bulk operations on results

**Backend:**
- [ ] Implement LeadServices.xml
- [ ] Implement lead record creation in backend
- [ ] Add lead status tracking and updates
- [ ] Create webhook/notification for real-time updates
- [ ] Ensure multi-tenant isolation on all queries

**Integration:**
- [ ] Test lead flow from assessment completion to backend
- [ ] Verify leads appear in admin dashboard
- [ ] Test lead/opportunity creation

**Verification:**
- [ ] Leads captured after assessment submission
- [ ] Visible in admin dashboard (pseudoIds)
- [ ] Backend can retrieve and filter leads
- [ ] Export functionality works

### Phase 5: Multi-Tenant Scaling & Production (Weeks 9-10)

**Frontend:**
- [ ] Add company selector for multi-company admin
- [ ] Implement page routing by landing_page pseudoId
- [ ] Add URL-based page loading

**Backend:**
- [ ] Enforce multi-tenant isolation on ALL queries
- [ ] Add ownerPartyId filter to every select
- [ ] Implement access control (company admin only)
- [ ] Add audit logging for results capture

**Testing:**
- [ ] End-to-end testing (all flows)
- [ ] Multi-tenant isolation testing
- [ ] Performance testing (<200ms target)
- [ ] Load testing (1,000+ concurrent)
- [ ] Mobile responsiveness testing

**Optimization:**
- [ ] Page content caching
- [ ] Database query optimization
- [ ] Image optimization
- [ ] API response optimization

**Security:**
- [ ] Security audit
- [ ] GDPR compliance check
- [ ] Rate limiting on public endpoints
- [ ] Encryption verification

**Documentation:**
- [ ] API documentation
- [ ] Admin user guide
- [ ] Developer guide for extending
- [ ] Deployment guide

**Verification:**
- [ ] All KPIs met (see Part 9)
- [ ] No security issues
- [ ] Performance targets achieved
- [ ] Ready for production

---

## Part 6: API Endpoints (Product-Agnostic, Dual-ID Support)

### Public APIs (No Authentication Required)

#### GET `/api/v1/page/{pageId|pseudoId}`
Fetch a page by either system ID or user-facing pseudo ID. Backend logic tries exact match first.

```json
Response:
{
  "pageId": "p_12345",
  "pseudoId": "p_abc123xyz",
  "title": "Customer Readiness Assessment",
  "headline": "Discover Your Current State",
  "hookType": "frustration",
  "subheading": "Answer our survey to get personalized insights",
  "sections": [
    {
      "sectionId": "sec_001",
      "pseudoId": "s_sec001",
      "title": "Current Challenges",
      "description": "Tell us about your business",
      "imageUrl": "...",
      "sequenceNum": 1
    }
  ],
  "credibility": {
    "credibilityId": "cred_001",
    "pseudoId": "c_cred001",
    "creatorBio": "...",
    "backgroundText": "...",
    "supportingStatistics": ["stat1", "stat2", "stat3"]
  },
  "primaryCTA": {
    "buttonText": "Start Survey",
    "estimatedTime": "5 minutes",
    "cost": "Free",
    "valuePromise": "Get actionable insights"
  }
}
```

#### GET `/api/v1/page/{pageId|pseudoId}/survey`
Fetch survey configuration for a page.

```json
Response:
{
  "surveyId": "s_12345",
  "pseudoId": "surv_abc123",
  "maxScore": 100,
  "questions": [
    {
      "questionId": "q1",
      "pseudoId": "q_001",
      "type": "info",
      "question": "What is your full name?",
      "fieldType": "text",
      "mandatory": true,
      "sequenceNum": 1
    },
    {
      "questionId": "q2",
      "pseudoId": "q_002",
      "type": "info",
      "question": "What is your email?",
      "fieldType": "email",
      "mandatory": true,
      "sequenceNum": 2
    },
    // ... more questions (type: survey or qualification)
  ]
}
```

#### POST `/api/v1/survey/submit`
Submit survey responses and get qualification result. Returns both IDs.

```json
Request:
{
  "pageId": "p_12345",           // OR use pseudoId instead
  "surveyId": "s_12345",         // OR use pseudoId instead
  "infoAnswers": {
    "q1": "John Doe",
    "q2": "john@example.com",
    "q3": "+1-555-0000",
    "q4": "Acme Corp"
  },
  "surveyAnswers": {
    "q5": "Yes",
    "q6": "No",
    // ... 8 more questions
  },
  "qualificationAnswers": {
    "q15": "Growing rapidly",
    "q16": "Improve efficiency",
    "q17": "Limited budget",
    "q18": "Need quick results",
    "q19": "Additional notes..."
  }
}

Response:
{
  "resultId": "r_12345",
  "pseudoId": "result_abc123xyz",
  "score": 75,
  "status": "Warm",
  "insights": [
    "Focus on process optimization",
    "Quick wins will build momentum",
    "Budget planning essential"
  ],
  "nextStepType": "presentation",
  "nextStepCTA": {
    "title": "Join Group Presentation",
    "description": "Learn best practices with peers",
    "link": "https://events.example.com/webinar-2025-01",
    "ctaId": "cta_001",
    "pseudoId": "cta_abc"
  }
}
```

### Admin APIs (Authentication Required)

#### GET `/api/v1/admin/pages?companyId={companyId}&limit=20&offset=0`
List all pages for a company. Returns pseudoIds for UI display.

```json
Response:
{
  "pages": [
    {
      "pageId": "p_001",
      "pseudoId": "page_abc123",
      "title": "Customer Assessment",
      "hookType": "frustration",
      "createdAt": "2025-01-15T10:30:00Z",
      "resultCount": 245
    }
  ],
  "total": 3,
  "limit": 20,
  "offset": 0
}
```

#### POST `/api/v1/admin/pages`
Create a new page. Backend generates pageId, optionally generates pseudoId.

```json
Request:
{
  "companyId": "comp_123",
  "pseudoId": "page_custom123",  // Optional, auto-generate if not provided
  "title": "New Survey",
  "headline": "Tell us about your needs",
  "hookType": "results",
  // ... other fields
}

Response:
{
  "pageId": "p_new123",
  "pseudoId": "page_custom123",
  "title": "New Survey",
  // ... full page data
}
```

#### PUT `/api/v1/admin/pages/{pageId|pseudoId}`
Update a page. Supports both ID types.

```json
Request:
{
  "title": "Updated Title",
  "headline": "Updated Headline"
  // ... fields to update
}
```

#### DELETE `/api/v1/admin/pages/{pageId|pseudoId}`
Delete a page. Supports both ID types.

#### GET `/api/v1/admin/survey/{surveyId|pseudoId}`
Get survey configuration. Supports both ID types.

#### PUT `/api/v1/admin/survey/{surveyId|pseudoId}`
Update survey configuration. Supports both ID types.

#### POST `/api/v1/admin/survey/{surveyId|pseudoId}/questions`
Add a question to survey.

```json
Request:
{
  "question": "What is your top priority?",
  "type": "survey",               // info, survey, or qualification
  "fieldType": "choice",          // text, email, phone, yes_no, choice, rating
  "options": [
    {"optionText": "Option 1", "optionWeight": 10},
    {"optionText": "Option 2", "optionWeight": 5}
  ],
  "mandatory": true,
  "sequenceNum": 5
}

Response:
{
  "questionId": "q_new456",
  "pseudoId": "q_custom456",
  // ... full question data
}
```

#### GET `/api/v1/admin/results?pageId={pageId|pseudoId}&status=Warm&limit=50`
List survey results with filtering. Supports both ID types.

```json
Response:
{
  "results": [
    {
      "resultId": "r_001",
      "pseudoId": "result_abc",
      "firstName": "John",
      "lastName": "Doe",
      "email": "john@example.com",
      "score": 75,
      "status": "Warm",
      "submittedAt": "2025-01-20T14:30:00Z"
    }
  ],
  "total": 42,
  "filters": {
    "pageId": "p_001",
    "status": "Warm"
  }
}
```

#### GET `/api/v1/admin/result/{resultId|pseudoId}`
Get detailed result. Supports both ID types.

#### GET `/api/v1/admin/results/export?pageId={pageId|pseudoId}&format=csv`
Export results as CSV or JSON. Supports both ID types.

```
format: csv | json
```

#### Error Responses (Standard)
```json
{
  "error": "invalid_page_id",
  "message": "Page not found with ID: p_invalid",
  "statusCode": 404
}
```

Common error codes:
- `404` - Resource not found
- `400` - Invalid request parameters
- `401` - Unauthorized
- `403` - Forbidden (different tenant)
- `409` - Duplicate pseudoId
- `500` - Server error

---

## Part 7: Database Schema Summary (Product-Agnostic, Dual-ID)

### Entity Relationship Diagram

```
Company (from mantle-udm)
  â”œâ”€â”€ Assessment (assessmentId + pseudoId)
  â”‚   â”œâ”€ AssessmentQuestion (multiple)
  â”‚   â”‚  â””â”€ AssessmentQuestionOption (multiple)
  â”‚   â”œâ”€ ScoringThreshold (multiple)
  â”‚   â””â”€ AssessmentResult (multiple)
  â”‚      â””â”€ AssessmentLead
  â”‚         â””â”€ Opportunity* (Optional: backend integration only)
  â”‚
  â””â”€â”€ LandingPage (pageId + pseudoId)
      â”œâ”€ Assessment (via assessmentId foreign key)
      â”œâ”€ PageSection (multiple)
      â”œâ”€ CredibilityInfo
      â”‚  â””â”€ CredibilityStatistic (multiple)
      â”œâ”€ PrimaryCTA
      â””â”€ AssessmentLead (via pageId)

*Note: Opportunity creation is entirely backend-driven; frontend has no dependency on marketing package
```

### Entity Tables Summary

#### growerp_assessment Entities
| Entity | PK | Unique | Purpose |
|--------|----|----- ------|---------|
| **Assessment** | assessmentId | pseudoId (per tenant) | Survey/Assessment configuration |
| **AssessmentQuestion** | questionId | pseudoId (per tenant) | Individual questions (3 types) |
| **AssessmentQuestionOption** | optionId | pseudoId (per tenant) | Answer options/choices |
| **ScoringThreshold** | thresholdId | pseudoId (per tenant) | Score ranges & statuses |
| **AssessmentResult** | resultId | pseudoId (per tenant) | Assessment submission result |

#### landing_page App Entities
| Entity | PK | Unique | Purpose |
|--------|----|----- ------|---------|
| **LandingPage** | pageId | pseudoId (per tenant) | Configurable page content |
| **PageSection** | sectionId | pseudoId (per tenant) | Page sections/blocks |
| **CredibilityInfo** | credibilityId | pseudoId (per tenant) | Creator/company info |
| **CredibilityStatistic** | statisticId | pseudoId (per tenant) | Supporting statistics |
| **PrimaryCTA** | ctaId | pseudoId (per tenant) | Call-to-action button |

#### Lead Integration Entity
| Entity | PK | Unique | Purpose |
|--------|----|----- ------|---------|
| **AssessmentLead** | leadId | pseudoId (per tenant) | Lead/Opportunity integration |

### Sample Data with Dual IDs

#### Assessment Configuration
```
assessmentId: a_assess_20251023_001   (system-wide unique)
pseudoId: assess_product_readiness    (tenant-unique, user-facing)
ownerPartyId: comp_acme
maxScore: 100

Questions:
  - questionId: q_001, pseudoId: q_name (Info: Name)
  - questionId: q_002, pseudoId: q_email (Info: Email)
  - questionId: q_003, pseudoId: q_001 (Survey: Has process automation?)
  - ... 9 more survey questions
  - questionId: q_013, pseudoId: q_sit (Qualification: Situation)
  - ... 4 more qualification questions

Scoring Thresholds:
  - thresholdId: t_001, pseudoId: thresh_cold (0-40, "Cold")
  - thresholdId: t_002, pseudoId: thresh_warm (41-70, "Warm")
  - thresholdId: t_003, pseudoId: thresh_hot (71-100, "Hot")
```

#### Landing Page Configuration
```
pageId: p_page_20251023_001           (system-wide unique)
pseudoId: page_product_readiness      (tenant-unique, user-facing)
ownerPartyId: comp_acme
assessmentId: a_assess_20251023_001   (references Assessment)
title: "Product Readiness Assessment"
hookType: "results"
headline: "Discover Your Current State"

Sections:
  - sectionId: sec_001, pseudoId: sec_challenges (Current Challenges)
  - sectionId: sec_002, pseudoId: sec_vision (Your Vision)
  - sectionId: sec_003, pseudoId: sec_solution (Our Solution)

Credibility:
  - credibilityId: cred_001, pseudoId: cred_expert
  - Statistics: [3 supporting stats]

PrimaryCTA:
  - ctaId: cta_001, pseudoId: cta_start
  - "Start Assessment" | "5 minutes" | "Free"
```

#### Assessment Result
```
resultId: r_result_20251023_001       (system-wide unique)
pseudoId: result_john_oct23           (tenant-unique, user-facing)
assessmentId: a_assess_20251023_001
pageId: p_page_20251023_001
firstName: "John"
lastName: "Doe"
email: "john@example.com"
score: 78
status: "Warm"
submittedAt: 2025-01-20T14:30:00Z
answersJson: { "q_name": "John Doe", "q_001": "Yes", ... }
insightsJson: ["Insight 1", "Insight 2", "Insight 3"]
nextStepType: "presentation"
```

#### Lead from Assessment
```
leadId: l_lead_20251023_001           (system-wide unique)
pseudoId: lead_john_doe               (tenant-unique, user-facing)
resultId: r_result_20251023_001       (from AssessmentResult)
pageId: p_page_20251023_001
qualificationScore: 78
qualificationStatus: "Warm"
leadStatus: "new"
createdAt: 2025-01-20T14:31:00Z
```
pageId: p_page_20251023_001        (system-wide unique)
pseudoId: page_product_readiness   (tenant-unique, user-facing)
ownerPartyId: comp_acme
title: "Product Readiness Assessment"
hookType: "results"
```

#### Survey with IDs
```
surveyId: s_survey_20251023_001    (system-wide unique)
pseudoId: survey_product_q2025     (tenant-unique, user-facing)
pageId: p_page_20251023_001
maxScore: 100
```

#### Question with IDs
```
questionId: q_q001_20251023        (system-wide unique)
pseudoId: q_001                    (tenant-unique)
surveyId: s_survey_20251023_001
question: "What is your company name?"
sequenceNum: 1
```

#### Result with IDs
```
resultId: r_result_20251023_001    (system-wide unique)
pseudoId: result_john_doe_oct23    (tenant-unique, user-facing)
surveyId: s_survey_20251023_001
pageId: p_page_20251023_001
firstName: "John"
lastName: "Doe"
email: "john@example.com"
score: 78
status: "Warm"
submittedAt: 2025-01-20T14:30:00Z
```

### Dual-ID Query Examples

#### Backend can query using either ID:
```groovy
// Using system ID
def page = entity.find(pageId: 'p_page_20251023_001')

// Using pseudo ID
def page = entity.find(pseudoId: 'page_product_readiness', ownerPartyId: 'comp_acme')

// Service handles both transparently
Page getPage(String pageIdOrPseudoId, String? ownerPartyId) {
  // Try exact match first
  if (isUuid(pageIdOrPseudoId)) {
    return findByPageId(pageIdOrPseudoId)
  }
  // Fall back to pseudoId lookup
  return findByPseudoId(pageIdOrPseudoId, ownerPartyId)
}
```

#### API supports both:
```
GET /api/v1/page/p_page_20251023_001
GET /api/v1/page/page_product_readiness
```

### Database Constraints

**Multi-Tenant Isolation:**
```sql
-- pseudoId is unique ONLY within a tenant
UNIQUE (ownerPartyId, pseudoId)

-- All queries filtered by ownerPartyId
WHERE ownerPartyId = :ownerPartyId
```

**Referential Integrity:**
```sql
-- Foreign keys use system IDs
PageSection.pageId â†’ Page.pageId
SurveyQuestion.surveyId â†’ Survey.surveyId
QualificationResult.surveyId â†’ Survey.surveyId
```

**Indexes for Performance:**
```sql
CREATE INDEX idx_page_owner ON Page(ownerPartyId)
CREATE INDEX idx_page_pseudoid ON Page(pseudoId, ownerPartyId)
CREATE INDEX idx_survey_page ON Survey(pageId)
CREATE INDEX idx_result_survey ON QualificationResult(surveyId)
CREATE INDEX idx_result_score ON QualificationResult(score)
CREATE INDEX idx_result_status ON QualificationResult(status)
CREATE INDEX idx_lead_email ON SurveyLead(email)
```

---

## Part 8: Security & Compliance Considerations

### Product-Agnostic Design
- âœ… No assumptions about product type or industry
- âœ… Configurable scoring thresholds and statuses (not just Cold/Warm/Hot)
- âœ… Customizable next-step routing and CTAs
- âœ… Generic field types support any survey use case
- âœ… Flexible result processing (any type of lead/opportunity)

### Data Privacy & Compliance
- âœ… GDPR-compliant consent capture on page
- âœ… Privacy policy link requirement
- âœ… Encrypted transmission of survey data
- âœ… Data retention policies (configurable per company)
- âœ… CCPA opt-out mechanism support
- âœ… Email field optional (can use external ID)

### Multi-Tenant Isolation (Dual-ID Strategy)
- âœ… All queries filtered by `ownerPartyId`
- âœ… Survey results isolated per tenant using system IDs (resultId)
- âœ… pseudoId unique only within tenant context
- âœ… Admin access restricted to company admins only
- âœ… Results/leads only visible to owning company
- âœ… Audit logging of who accessed what

### Security Best Practices
- âœ… System IDs (entityId) never exposed to frontend directly
- âœ… Only pseudoIds shown in URLs and admin UI
- âœ… Both ID types available in APIs for backend flexibility
- âœ… Service-layer validation of multi-tenant context
- âœ… Encryption of sensitive data at rest
- âœ… Rate limiting on public survey endpoints

### Performance & Scalability
- âœ… Page content caching (CDN-friendly static content)
- âœ… Survey result async processing (non-blocking)
- âœ… Lead capture batching for bulk operations
- âœ… Database indexing on system IDs and timestamps
- âœ… Query optimization with multi-tenant filters
- âœ… Efficient JSON storage for answers

---

## Part 9: Success Metrics

### Key Performance Indicators (KPIs)

| Metric | Target | Tracking |
|--------|--------|----------|
| Landing Page Completion Rate | >60% | Results captured / LP views |
| Hot Lead Percentage | >20% | Warm/Hot / Total leads |
| Lead Capture Latency | <2 seconds | Assessment submit â†’ Lead visible |
| Form Abandonment Rate | <15% | Starts / Completions |
| Mobile Conversion | 80% of desktop | Mobile vs Desktop comparison |
| Lead to Opportunity | >40% | Marked as opportunity / Total leads |

---

## Part 10: Future Enhancements (Phase 2+)

### Recommendations for Future Phases

1. **A/B Testing Module**
   - Test different hooks/headlines
   - Test different CTAs
   - Track conversion differences

2. **Advanced Scoring**
   - Machine learning-based scoring
   - Predictive lead quality scoring
   - Dynamic weight adjustment based on outcomes

3. **Email Integration**
   - Automated follow-up sequences
   - Personalized email based on score
   - Drip campaigns by lead status

4. **CRM Integration**
   - Salesforce two-way sync
   - HubSpot native integration
   - Zapier webhook support

5. **Retargeting Pixels**
   - Facebook pixel integration
   - Google Analytics 4 events
   - Custom retargeting audiences

6. **Multi-Language Support**
   - Internationalized content
   - Per-landing-page language settings
   - Auto-translate with human review

7. **Video Integration**
   - Video backgrounds on landing page
   - Testimonial videos in credibility section
   - Video responses to specific insights

8. **Conditional Logic**
   - Show/hide questions based on previous answers
   - Dynamic assessment length
   - Adaptive assessment paths

---

## Summary: Architecture Decision Records (ADRs)

| Decision | Rationale | Trade-offs |
|----------|-----------|-----------|
| Flutter for LP | Cross-platform consistency | Web limitations (use web target) |
| BLoC pattern | GrowERP standard, separation of concerns | Learning curve for new devs |
| Multi-landing-page per company | Marketing flexibility | Complexity in admin UI |
| JSON for answers storage | Flexible schema, easy extensibility | Query complexity |
| Async lead capture | Non-blocking UX, background processing | Potential race conditions (mitigated) |
| Public API for LP | Easy embedding, white-labeling ready | Security requires rate limiting |
| Dynamic CTA routing | Personalization, sales efficiency | Complex logic to maintain |

---

## Appendix A: File Manifest

### Frontend Files to Create - growerp_assessment Package
```
flutter/packages/growerp_assessment/
â”œâ”€â”€ lib/src/models/
â”‚   â”œâ”€â”€ assessment_model.dart
â”‚   â”œâ”€â”€ assessment_question_model.dart
â”‚   â”œâ”€â”€ assessment_result_model.dart
â”‚   â””â”€â”€ scoring_rule_model.dart
â”œâ”€â”€ lib/src/services/
â”‚   â”œâ”€â”€ assessment_service.dart
â”‚   â””â”€â”€ assessment_scoring_service.dart
â”œâ”€â”€ lib/src/bloc/
â”‚   â”œâ”€â”€ assessment_bloc.dart
â”‚   â”œâ”€â”€ assessment_event.dart
â”‚   â””â”€â”€ assessment_state.dart
â”œâ”€â”€ lib/src/screens/
â”‚   â”œâ”€â”€ assessment_screen.dart
â”‚   â”œâ”€â”€ step1_info_screen.dart
â”‚   â”œâ”€â”€ step2_questions_screen.dart
â”‚   â”œâ”€â”€ step3_qualification_screen.dart
â”‚   â””â”€â”€ result_screen.dart
â”œâ”€â”€ lib/src/widgets/
â”‚   â”œâ”€â”€ assessment_question_widget.dart
â”‚   â”œâ”€â”€ progress_indicator.dart
â”‚   â”œâ”€â”€ score_gauge_widget.dart
â”‚   â””â”€â”€ result_summary_widget.dart
â”œâ”€â”€ lib/src/constants/
â”‚   â””â”€â”€ assessment_constants.dart
â”œâ”€â”€ lib/src/utils/
â”‚   â””â”€â”€ assessment_calculator.dart
â”œâ”€â”€ lib/growerp_assessment.dart
â”œâ”€â”€ lib/get_assessment_bloc_providers.dart
â”œâ”€â”€ pubspec.yaml
â”œâ”€â”€ README.md
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ example/lib/main.dart
â””â”€â”€ example/integration_test/assessment_test.dart
```

### Frontend Files to Create - landing_page App
```
flutter/packages/landing_page/
â”œâ”€â”€ lib/src/models/
â”‚   â”œâ”€â”€ landing_page_model.dart
â”‚   â”œâ”€â”€ page_section_model.dart
â”‚   â”œâ”€â”€ credibility_model.dart
â”‚   â””â”€â”€ cta_model.dart
â”œâ”€â”€ lib/src/services/
â”‚   â”œâ”€â”€ landing_page_service.dart
â”‚   â””â”€â”€ lead_capture_service.dart
â”œâ”€â”€ lib/src/bloc/
â”‚   â”œâ”€â”€ landing_page_bloc.dart
â”‚   â”œâ”€â”€ landing_page_event.dart
â”‚   â”œâ”€â”€ landing_page_state.dart
â”‚   â”œâ”€â”€ lead_capture_bloc.dart
â”‚   â”œâ”€â”€ lead_capture_event.dart
â”‚   â””â”€â”€ lead_capture_state.dart
â”œâ”€â”€ lib/src/screens/
â”‚   â”œâ”€â”€ landing_page_screen.dart
â”‚   â”œâ”€â”€ assessment_flow_screen.dart
â”‚   â””â”€â”€ results_screens/
â”‚       â”œâ”€â”€ score_reveal_screen.dart
â”‚       â”œâ”€â”€ insights_screen.dart
â”‚       â”œâ”€â”€ summary_screen.dart
â”‚       â””â”€â”€ thank_you_screen.dart
â”œâ”€â”€ lib/src/widgets/
â”‚   â”œâ”€â”€ page_hero.dart
â”‚   â”œâ”€â”€ section_widget.dart
â”‚   â”œâ”€â”€ credibility_section.dart
â”‚   â”œâ”€â”€ cta_button.dart
â”‚   â””â”€â”€ privacy_policy_link.dart
â”œâ”€â”€ lib/src/constants/
â”‚   â””â”€â”€ landing_page_constants.dart
â”œâ”€â”€ lib/src/utils/
â”‚   â””â”€â”€ page_validators.dart
â”œâ”€â”€ lib/landing_page.dart
â”œâ”€â”€ lib/get_landing_page_bloc_providers.dart
â”œâ”€â”€ pubspec.yaml
â”œâ”€â”€ README.md
â””â”€â”€ CHANGELOG.md
```

### Frontend Files to Create - Admin Package Integration
```
flutter/packages/admin/lib/src/landing_page/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ landing_page_main_page.dart
â”‚   â”œâ”€â”€ landing_page_list_page.dart
â”‚   â”œâ”€â”€ landing_page_detail_page.dart
â”‚   â”œâ”€â”€ landing_page_editor_page.dart
â”‚   â”œâ”€â”€ assessment_list_page.dart
â”‚   â”œâ”€â”€ assessment_builder_page.dart
â”‚   â””â”€â”€ results_dashboard_page.dart
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ landing_page_list_view.dart
â”‚   â”œâ”€â”€ landing_page_editor_view.dart
â”‚   â”œâ”€â”€ assessment_builder_view.dart
â”‚   â”œâ”€â”€ scoring_config_view.dart
â”‚   â”œâ”€â”€ insights_mapper_view.dart
â”‚   â””â”€â”€ results_list_view.dart
â”œâ”€â”€ widgets/
â”‚   â”œâ”€â”€ page_preview_widget.dart
â”‚   â”œâ”€â”€ section_editor_widget.dart
â”‚   â”œâ”€â”€ question_builder_widget.dart
â”‚   â”œâ”€â”€ cta_mapper_widget.dart
â”‚   â””â”€â”€ results_filter_widget.dart
â””â”€â”€ bloc/
    â”œâ”€â”€ admin_landing_page_bloc.dart
    â””â”€â”€ admin_assessment_bloc.dart
```

### Backend Files to Create
```
moqui/runtime/component/growerp/service/
  â”œâ”€â”€ AssessmentServices.xml
  â”œâ”€â”€ LandingPageServices.xml
  â””â”€â”€ LeadServices.xml

moqui/runtime/component/growerp/entity/
  â”œâ”€â”€ AssessmentEntities.xml
  â””â”€â”€ LandingPageEntities.xml

moqui/runtime/component/growerp/data/
  â””â”€â”€ SampleAssessmentAndPageData.xml
```

### Documentation Files
```
docs/
  â”œâ”€â”€ LANDING_PAGE_IMPLEMENTATION_PLAN.md (this file)
  â”œâ”€â”€ LANDING_PAGE_API_REFERENCE.md
  â”œâ”€â”€ LANDING_PAGE_ADMIN_GUIDE.md
  â”œâ”€â”€ ASSESSMENT_SCORING_GUIDE.md
  â””â”€â”€ LANDING_PAGE_MIGRATION_GUIDE.md
```

---

**Document Version:** 1.0  
**Last Updated:** October 23, 2025  
**Next Review:** Before Phase 1 Implementation
